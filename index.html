<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chat Perfeito</title>
    <script src="/socket.io/socket.io.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Abril+Fatface&family=Bebas+Neue&family=Cormorant+Garamond:wght@400;700&family=Dancing+Script:wght@400;700&family=Fjalla+One&family=IBM+Plex+Sans:wght@400;700&family=Indie+Flower&family=Josefin+Sans:wght@400;700&family=Lobster&family=Lora:wght@400;700&family=Merriweather:wght@400;700&family=Montserrat:wght@400;700&family=Oswald:wght@400;700&family=Pacifico&family=Permanent+Marker&family=Playfair+Display:wght@400;700&family=Poppins:wght@400;700&family=Quicksand:wght@400;700&family=Raleway:wght@400;400&family=Satisfy&family=Source+Sans+Pro:wght@400;700&family=Spectral:wght@400;700&family=Ubuntu:wght@400;700&family=Varela+Round&display=swap" rel="stylesheet">
    <style>
        /* Estilos para o chat */
        .chat-container {
            width: 540px;
            height: 430px;
            margin: 0 auto;
            border-radius: 15px;
            overflow: hidden;
            position: relative;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
            background-image: url('https://i.imgur.com/qkWxt2w.png');
            background-size: auto 100%;
            background-position: left center;
            border: 3px solid #0000ff;
            animation: neon-border 3s infinite alternate;
            display: flex;
            flex-direction: column;
            box-sizing: border-box;
        }
        @keyframes background-pan {
            0% { background-position: left center; }
            100% { background-position: right center; }
        }
        .chat-container.background-animated {
            animation: neon-border 3s infinite alternate, background-pan 30s infinite linear alternate;
        }
        @keyframes neon-border {
            0%   { border-color: #0000ff; }
            33%  { border-color: #8A2BE2; }
            66%  { border-color: #FF69B4; }
            100% { border-color: #0000ff; }
        }
        .chat-box {
            flex-grow: 1;
            padding: 5px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            justify-content: flex-end;
            color: white;
            text-shadow: 1px 1px 2px #000;
        }
        .chat-box p {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(5px);
            padding: 3px 8px;
            border-radius: 5px;
            margin: 2px 0;
            line-height: 1.2;
        }
        .chat-box p:first-child {
            margin-top: auto;
        }
        .chat-input-area {
            padding: 5px;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            flex-direction: column;
            position: relative;
        }
        .chat-button-group {
            display: flex;
            margin-top: 5px;
            align-items: center;
            gap: 5px;
        }
        .chat-input {
            padding: 6px;
            border: none;
            border-radius: 5px;
            width: 100px;
            font-size: 0.9em;
        }
        #message-input {
            flex-grow: 1;
            margin-left: 0;
            margin-right: 0;
        }
        .chat-button, .users-list-button, .emoji-button {
            padding: 6px 10px;
            font-size: 0.9em;
        }
        .users-list-panel, .emoji-panel {
            display: none;
            position: absolute;
            top: 40px;
            right: 5px;
            width: 200px;
            background: rgba(0, 0, 0, 0.8);
            border-radius: 10px;
            padding: 10px;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.5);
            z-index: 200;
            color: white;
            font-family: Arial, sans-serif;
            flex-direction: column;
            max-height: 300px;
            overflow-y: auto;
        }
        .settings-panel {
            display: none;
            position: absolute;
            top: 40px;
            right: 5px;
            width: 200px;
            background: rgba(0, 0, 0, 0.8);
            border-radius: 10px;
            padding: 10px;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.5);
            z-index: 200;
            color: white;
            font-family: Arial, sans-serif;
            flex-direction: column;
        }
        .settings-panel h6 {
            margin-top: 0;
            margin-bottom: 8px;
            border-bottom: 1px solid #444;
            padding-bottom: 3px;
            font-size: 0.9em;
        }
        .settings-panel .setting-row {
            margin-bottom: 10px;
        }
        .settings-panel .setting-row .setting-label {
            display: block;
            margin-bottom: 3px;
            font-size: 0.8em;
        }
        .settings-panel .toolbar-buttons button,
        .status-icons button {
            width: 30px;
            height: 30px;
            font-size: 1em;
            padding: 0;
        }
        .settings-panel .setting-row input[type="color"] {
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            width: 30px;
            height: 30px;
            border: 1px solid #ccc;
            border-radius: 5px;
            cursor: pointer;
            background-color: transparent;
        }
        .settings-panel .setting-row input[type="color"]::-webkit-color-swatch-wrapper {
            padding: 0;
        }
        .settings-panel .setting-row input[type="color"]::-webkit-color-swatch {
            border: none;
            border-radius: 4px;
        }
        .settings-panel .setting-row input[type="color"]::-moz-color-swatch {
            border: none;
            border-radius: 4px;
        }
        .settings-button {
            position: absolute;
            top: 5px;
            right: 5px;
            width: 25px;
            height: 25px;
            background-color: #333;
            color: white;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            z-index: 150;
            font-size: 1em;
            border: 2px solid white;
        }
        .status-icons {
            gap: 5px;
        }
        .font-select-container {
            max-height: 100px !important;
        }
        .close-btn {
            position: absolute;
            top: 5px;
            right: 10px;
            font-size: 1.5em;
            cursor: pointer;
            color: #fff;
        }
        .status-indicator {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            margin-right: 5px;
        }
        .status-indicator.online { background-color: #28a745; }
        .status-indicator.busy { background-color: #dc3545; }
        .status-indicator.away { background-color: #6c757d; }
        .emoji-panel {
            padding: 0;
            display: none;
        }
        .emoji-tabs {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-around;
            padding: 5px 0;
            background: rgba(0, 0, 0, 0.7);
            border-bottom: 1px solid #444;
        }
        .emoji-tabs button {
            background: none;
            border: none;
            font-size: 1.2em;
            cursor: pointer;
            padding: 5px;
            color: #aaa;
            transition: color 0.2s;
        }
        .emoji-tabs button.active {
            color: #fff;
            border-bottom: 2px solid #fff;
        }
        .emoji-category {
            display: none;
            flex-wrap: wrap;
            padding: 10px;
            gap: 8px;
            max-height: 250px;
            overflow-y: auto;
        }
        .emoji-category.active {
            display: flex;
        }
        .emoji-category button {
            background: none;
            border: none;
            font-size: 1.5em;
            cursor: pointer;
            padding: 2px;
            line-height: 1;
            color: white;
        }
        .emoji-category button:hover {
            transform: scale(1.2);
            transition: transform 0.2s ease;
        }
    </style>
</head>
<body>
    <div class="chat-container">
        <div class="settings-button" onclick="toggleSettingsPanel()">‚öôÔ∏è</div>
        <div class="chat-box" id="chat-messages"></div>
        <div id="users-list-panel" class="users-list-panel">
            <span class="close-btn" onclick="toggleUsersList()">√ó</span>
            <h6>Online</h6>
            <ul id="users-list"></ul>
        </div>
        <div id="emoji-panel" class="emoji-panel">
            <div class="emoji-tabs">
                <button onclick="showEmojiCategory('smileys')" class="active">üòÄ</button>
                <button onclick="showEmojiCategory('people')">üßë</button>
                <button onclick="showEmojiCategory('animals')">üê∂</button>
                <button onclick="showEmojiCategory('food')">üçî</button>
                <button onclick="showEmojiCategory('travel')">‚úàÔ∏è</button>
                <button onclick="showEmojiCategory('activity')">‚öΩ</button>
                <button onclick="showEmojiCategory('objects')">üí°</button>
                <button onclick="showEmojiCategory('symbols')">‚ù§Ô∏è</button>
                <button onclick="showEmojiCategory('flags')">üèÅ</button>
                <button onclick="showEmojiCategory('transportes')">üöÜ</button>
                <button onclick="showEmojiCategory('tecnologia')">üì±</button>
                <button onclick="showEmojiCategory('saude')">üíâ</button>
                <button onclick="showEmojiCategory('esportes')">üèÄ</button>
                <button onclick="showEmojiCategory('profissoes')">üë®‚ÄçüöÄ</button>
            </div>
            <div id="smileys" class="emoji-category active"></div>
            <div id="people" class="emoji-category"></div>
            <div id="animals" class="emoji-category"></div>
            <div id="food" class="emoji-category"></div>
            <div id="travel" class="emoji-category"></div>
            <div id="activity" class="emoji-category"></div>
            <div id="objects" class="emoji-category"></div>
            <div id="symbols" class="emoji-category"></div>
            <div id="flags" class="emoji-category"></div>
            <div id="transportes" class="emoji-category"></div>
            <div id="tecnologia" class="emoji-category"></div>
            <div id="saude" class="emoji-category"></div>
            <div id="esportes" class="emoji-category"></div>
            <div id="profissoes" class="emoji-category"></div>
        </div>
        <div id="settings-panel" class="settings-panel">
            <span class="close-btn" onclick="toggleSettingsPanel()">√ó</span>
            <h6>Configura√ß√µes de Tema</h6>
            <div class="setting-row">
                <label for="username-color">Cor do seu nome:</label>
                <input type="color" id="username-color" value="#FFFFFF" />
            </div>
            <div class="setting-row">
                <label for="text-color">Cor da sua mensagem:</label>
                <input type="color" id="text-color" value="#FFFFFF" />
            </div>
            <div class="setting-row">
                <div class="setting-label">Ferramentas de Texto</div>
                <div class="toolbar-buttons">
                    <button onclick="formatText('bold')" title="Negrito"><b>B</b></button>
                    <button onclick="formatText('italic')" title="It√°lico"><i>I</i></button>
                    <button onclick="formatText('underline')" title="Sublinhado"><u>U</u></button>
                    <button onclick="formatText('strike')" title="Riscado"><s>S</s></button>
                    <button onclick="toggleTextShadow()" id="shadow-toggle-button" title="Ativar/Desativar Sombra">S</button>
                </div>
            </div>
            <div class="setting-row">
                <div class="setting-label">Fonte:</div>
                <div class="font-select-container">
                    <select id="font-select" onchange="changeFont()" size="5">
                        <option value="Arial">Arial</option>
                        <option value="Roboto">Roboto</option>
                        <option value="'Permanent Marker'">Permanent Marker</option>
                        <option value="Pacifico">Pacifico</option>
                        <option value="'Fjalla One'">Fjalla One</option>
                        <option value="Lobster">Lobster</option>
                        <option value="'Dancing Script'">Dancing Script</option>
                        <option value="Oswald">Oswald</option>
                        <option value="'Bebas Neue'">Bebas Neue</option>
                        <option value="Merriweather">Merriweather</option>
                        <option value="'Playfair Display'">Playfair Display</option>
                        <option value="'Abril Fatface'">Abril Fatface</option>
                        <option value="'Cormorant Garamond'">Cormorant Garamond</option>
                        <option value="'IBM Plex Sans'">IBM Plex Sans</option>
                        <option value="'Indie Flower'">Indie Flower</option>
                        <option value="'Josefin+Sans'">Josefin Sans</option>
                        <option value="Lora">Lora</option>
                        <option value="Montserrat">Montserrat</option>
                        <option value="Poppins">Poppins</option>
                        <option value="Quicksand">Quicksand</option>
                        <option value="Raleway">Raleway</option>
                        <option value="Satisfy">Satisfy</option>
                        <option value="'Source Sans Pro'">Source Sans Pro</option>
                        <option value="Spectral">Spectral</option>
                        <option value="Ubuntu">Ubuntu</option>
                        <option value="'Varela Round'">Varela Round</option>
                    </select>
                </div>
            </div>
            <div class="setting-row">
                <span class="setting-label">Seu Status:</span>
                <div class="status-icons">
                    <button onclick="setStatus('online')" title="Presente">üü¢</button>
                    <button onclick="setStatus('busy')" title="Ocupado">üî¥</button>
                    <button onclick="setStatus('away')" title="Ausente">‚ö™</button>
                </div>
            </div>
            <div class="setting-row">
                <button onclick="toggleBackground()" id="background-toggle-btn">Desativar Fundo</button>
            </div>
        </div>
        <div class="chat-input-area">
            <div class="chat-button-group">
                <input type="text" id="username-input" class="chat-input" placeholder="Seu nome..." />
                <input type="text" id="message-input" class="chat-input" placeholder="Sua mensagem..." disabled />
                <button id="send-button" class="chat-button" disabled>üí¨</button>
                <button id="users-list-button" class="users-list-button" onclick="toggleUsersList()">üë•</button>
                <button id="emoji-button" class="emoji-button" onclick="toggleEmojiPanel()">üòä</button>
            </div>
        </div>
    </div>
    <script>
        const socket = io('https://meu-chat-lin7.onrender.com');

        // Vari√°veis globais para os elementos
        let currentUser = '';
        let currentUsernameColor = '#FFFFFF';
        let currentTextColor = '#FFFFFF';
        let isBackgroundActive = true;
        let isTextShadowActive = true;

        const emojiCategories = {
            smileys: [
                'üòÄ', 'üòÅ', 'üòÇ', 'ü§£', 'üòÉ', 'üòÑ', 'üòÖ', 'üòÜ', 'üòá', 'üòâ', 'üòä', 'üòã', 'üòå', 'üòç', 'ü•∞', 'üòò', 'üòó', 'üòô', 'üòö', 'ü§ó', 'ü§©', 'ü§î', 'ü§®', 'üòê', 'üòë', 'üò∂', 'üòè', 'üòí', 'üôÑ', 'üò¨', 'ü§•', 'üòå', 'üòî', 'üò™', 'ü§§', 'üò¥', 'üò∑', 'ü§í', 'ü§ï', 'ü§¢', 'ü§Æ', 'ü§ß', 'ü•µ', 'ü•∂', 'üòµ', 'ü§Ø', 'ü§†', 'ü•≥', 'üòé', 'ü§ì', 'üßê', 'üòï', 'üòü', 'üôÅ', 'üòÆ', 'üòØ', 'üò≤', 'üò≥', 'ü•∫', 'üò≠', 'üò¢', 'üò•', 'üò®', 'üò±', 'üò´', 'üò©', 'üò§', 'üò°', 'üò†', 'üòà', 'üëπ', 'üë∫', 'ü§°', 'üëª', 'üíÄ', '‚ò†Ô∏è', 'üí©', 'üëΩ', 'üëæ', 'ü§ñ'
            ],
            people: [
                'üßë', 'üëß', 'üë¶', 'üë®', 'üë©', 'üë¥', 'üëµ', 'üë∂', 'üëº', 'ü§¥', 'üë∏', 'ü§µ', 'üë∞', 'ü¶∏', 'ü¶π', 'üßë‚Äç‚öïÔ∏è', 'üßë‚Äçüéì', 'üßë‚Äçüè´', 'üßë‚Äç‚öñÔ∏è', 'üßë‚Äçüåæ', 'üßë‚Äçüç≥', 'üßë‚Äçüîß', 'üßë‚Äçüè≠', 'üßë‚Äçüíª', 'üßë‚Äçüíº', 'üßë‚Äçüî¨', 'üßë‚Äçüé®', 'üßë‚Äçüöí', 'üßë‚Äç‚úàÔ∏è', 'üßë‚ÄçüöÄ', 'üëÆ', 'üïµÔ∏è', 'üíÇ', 'üë∑', 'üßë‚Äçüé§', 'üßò', 'üíÉ', 'üï∫', 'üëØ', 'üßë‚Äçü§ù‚Äçüßë', 'ü´Ç', 'üö∂', 'üèÉ', 'üßç', 'üßé', 'ü§æ', 'üö¥', 'ü§∏', '‚õπÔ∏è', 'ü§º'
            ],
            animals: [
                'üê∂', 'üê±', 'üê≠', 'üêπ', 'üê∞', 'üêª', 'üêº', 'üê®', 'üêØ', 'ü¶Å', 'üêÆ', 'üê∑', 'üê∏', 'üêí', 'ü¶ç', 'üêî', 'üêß', 'ü¶Ö', 'ü¶â', 'ü¶ã', 'üêõ', 'üêù', 'üêû', 'üê†', 'üê¨', 'üê≥', 'ü¶à', 'üêä', 'üêâ', 'ü¶ï', 'ü¶ñ', 'üêé', 'ü¶ì', 'ü¶í', 'üêò', 'ü¶è', 'üê™', 'üê´', 'üêñ', 'üêè', 'üêë', 'üêê', 'ü¶å', 'üêà‚Äç‚¨õ', 'ü¶¢', 'ü¶î', 'üêøÔ∏è', 'üêá'
            ],
            food: [
                'üçé', 'üçè', 'üçê', 'üçä', 'üçã', 'üçå', 'üçâ', 'üçá', 'üçì', 'üçí', 'üçë', 'ü•≠', 'üçç', 'ü••', 'ü•ù', 'üçÖ', 'üçÜ', 'ü•ë', 'ü•¶', 'ü•¨', 'ü•í', 'üåΩ', 'ü•ï', 'ü•î', 'üå∂Ô∏è', 'üçÑ', 'ü•ú', 'üå∞', 'üçû', 'ü•ê', 'ü•ñ', 'ü•®', 'ü•û', 'üßá', 'üßÄ', 'üçó', 'üçñ', 'üçî', 'üçü', 'üçï', 'üå≠', 'üåÆ', 'üåØ', 'ü•ô', 'üßÜ', 'ü•ö', 'üç≥', 'ü•ì', 'ü•©', 'üçù', 'üçú', 'üç≤', 'üçõ', 'üç£', 'üç§', 'üçô', 'üçö', 'üçò', 'üç•', 'üç°', 'üç¢', 'üçß', 'üç®', 'üç¶', 'ü•ß', 'üç∞', 'üéÇ', 'üçÆ', 'üç≠', 'üç¨', 'üç´', 'üç©', 'üç™', '‚òï', 'üçµ', 'üßâ', 'üßã', 'ü•õ', 'ü•§', 'üç∂', 'üç∫', 'üçª', 'ü•Ç', 'üç∑', 'ü•É', 'üç∏', 'üçπ', 'üçæ', 'üßÇ', 'ü•£', 'ü•¢', 'ü•Ñ'
            ],
            travel: [
                'üöó', 'üöï', 'üöå', 'üöé', 'üèéÔ∏è', 'üöì', 'üöë', 'üöí', 'üöê', 'üõª', 'üöõ', 'üöú', 'üõµ', 'üèçÔ∏è', 'üö≤', 'üõ¥', 'üöÑ', 'üöÖ', 'üöÇ', 'üöÜ', 'üöá', 'üöà', 'üöâ', 'üöä', 'üöÅ', '‚úàÔ∏è', 'üöÄ', 'üõ∏', '‚õµ', 'üõ≥Ô∏è', 'üõ•Ô∏è', 'üö¢', '‚öì', 'üó∫Ô∏è', 'üß≠', 'üåâ', 'üåÉ', 'üèôÔ∏è', 'üåÜ', 'üåá', 'üè†', 'üè°', 'üè¢', 'üè£', 'üè§', 'üè•', 'üè¶', 'üè®', 'üè´', 'üè™', 'üè™', 'üè≠', 'üè∞', 'üèØ', 'üèüÔ∏è', 'üóΩ', 'üóº', 'üóª', 'üåÑ', 'üåÖ', 'üèúÔ∏è', 'üèûÔ∏è', 'üõ§Ô∏è', 'üõ£Ô∏è', 'üó∫Ô∏è', 'üåê'
            ],
            activity: [
                '‚öΩ', 'üèÄ', 'üèà', '‚öæ', 'ü•é', 'üéæ', 'üèê', 'üèâ', 'üèì', 'üè∏', 'üèí', 'üèë', 'üèè', 'ü•ç', 'ü™É', 'ü•Ö', '‚õ≥', 'üéØ', 'üé≥', 'üé±', 'ü•ä', 'ü•ã', 'üõπ', 'üõº', 'ü§ø', 'üèÑ‚Äç‚ôÇÔ∏è', 'üèä‚Äç‚ôÄÔ∏è', 'ü§Ω', 'üö£', 'ü§∏', 'üèãÔ∏è', 'üßò', 'üèá', 'üèÜ', 'ü•á', 'ü•à', 'ü•â', 'üèÖ', 'üéñÔ∏è', 'üéóÔ∏è', 'üé´', 'üéüÔ∏è', 'üé≠', 'üé®', 'üé¨', 'üé§', 'üéß', 'ü•Å', 'üé∑', 'üé∫', 'üé∏', 'üéª', 'üé≤', 'üß©', 'üéÆ', 'üïπÔ∏è', 'üé∞', 'ü™Å'
            ],
            objects: [
                '‚åö', 'üì±', 'üíª', 'üñ•Ô∏è', '‚å®Ô∏è', 'üñ®Ô∏è', 'üñ±Ô∏è', 'üîã', 'üîå', 'üí°', 'üî¶', '‚òéÔ∏è', 'üìû', 'üì†', 'üíæ', 'üíø', 'üìÄ', 'üßÆ', 'üíª', 'üì±', 'üì±', '‚òéÔ∏è', 'üìû', 'üì†', 'üîã', 'üîå', 'üí°', 'üî¶', 'üîó', 'üîí', 'üîì', 'üîë', 'üóùÔ∏è', 'üî™', 'üó°Ô∏è', 'üî´', 'üí£', 'üõ°Ô∏è', '‚öîÔ∏è', 'üèπ', 'üîß', 'üî®', '‚õèÔ∏è', 'ü™ì', 'üß±', 'üß±', 'üî©', '‚öôÔ∏è', '‚öñÔ∏è', '‚õìÔ∏è', 'ü™ö', 'üõ†Ô∏è'
            ],
            symbols: [
                '‚ù§Ô∏è', 'üß°', 'üíõ', 'üíö', 'üíô', 'üíú', 'ü§é', 'üñ§', 'ü§ç', 'üíî', '‚ù£Ô∏è', 'üíï', 'üíû', 'üíì', 'üíó', 'üíñ', 'üíò', 'üíù', 'üß°', 'üíõ', 'üíö', 'üíô', 'üíú', 'üñ§', 'ü§ç', 'ü§é', 'üíØ', '‚úîÔ∏è', '‚úÖ', '‚ùå', '‚ùé', '‚ùì', '‚ùî', '‚ùï', '‚ùó', '‚ÅâÔ∏è', '‚ûï', '‚ûñ', '‚úñÔ∏è', '‚ûó', '‚ôæÔ∏è', '‚≠ê', '‚ú®', 'üåü', 'üí´', 'üí•', 'üî•', 'üåà', '‚òÄÔ∏è', 'üåï', '‚ö°', 'üíß', 'üåä', 'üí®', 'üå™Ô∏è', 'üåÄ'
            ],
            flags: [
                'üáßüá∑', 'üá∫üá∏', 'üáØüáµ', 'üá®üá¶', 'üá®üá≥', 'üá´üá∑', 'üá©üá™', 'üáÆüá≥', 'üáÆüáπ', 'üá≤üáΩ', 'üá∑üá∫', 'üá™üá∏', 'üá¨üáß', 'üá¶üá∫', 'üá¶üá∑', 'üáßüá™', 'üá®üá±', 'üá®üá¥', 'üá®üá∫', 'üá™üá¨', 'üá¨üá∑', 'üá≠üá∞', 'üáÆüá©', 'üáÆüá™', 'üáÆüá±', 'üá∞üá∑', 'üá≥üá±', 'üá≥üá¥', 'üáµüáπ', 'üá∏üá¶', 'üá∏üá™', 'üáπüá≠', 'üáπüá∑', 'üáªüá≥', 'üáøüá¶', 'üá∞üá∑', 'üá≤üáΩ', 'üá¶üá™', 'üá¶üá∫', 'üá¶üáπ', 'üáßüá™', 'üá®üá≠', 'üá®üáø', 'üá©üá∞', 'üá´üáÆ'
            ],
            transportes: [
                'üöó', 'üöï', 'üöå', 'üöé', 'üèéÔ∏è', 'üöì', 'üöë', 'üöí', 'üöê', 'üõª', 'üöõ', 'üöú', 'üõµ', 'üèçÔ∏è', 'üö≤', 'üõ¥', 'ü¶º', 'ü¶Ω', 'üõ∫', 'üöÇ', 'üöÜ', 'üöá', 'üöà', 'üöâ', 'üöä', 'üöù', 'üöã', 'üöü', 'üö†', 'üö°', 'üöÉ', 'üöÑ', 'üöÖ', '‚úàÔ∏è', 'üõ´', 'üõ¨', 'üí∫', 'üöÄ', 'üõ∏', 'üõ∞Ô∏è', 'üöÅ', 'üõ∂', '‚õµ', 'üö§', 'üõ•Ô∏è', 'üõ≥Ô∏è', '‚õ¥Ô∏è', 'üö¢', '‚öì', '‚õΩ'
            ],
            tecnologia: [
                'üì±', 'üíª', 'üñ•Ô∏è', '‚å®Ô∏è', 'üñ±Ô∏è', 'üñ≤Ô∏è', 'üñ®Ô∏è', 'üì†', 'üîå', 'üîã', 'ü™´', 'üí°', 'üî¶', '‚è∞', 'üï∞Ô∏è', 'üì∫', 'üìª', 'üéôÔ∏è', 'üéöÔ∏è', 'üéõÔ∏è', 'üé§', 'üéß', 'üéº', 'üéµ', 'üé∂', 'üìΩÔ∏è', 'üé¨', 'üé•', 'üìπ', 'üì∑', 'üì∏', 'üìü', 'üìû', '‚òéÔ∏è', 'üì≤', 'üíª', 'üñ•Ô∏è', 'üñ®Ô∏è', '‚å®Ô∏è', 'üñ±Ô∏è', 'üñ≤Ô∏è', 'üî¶', 'üí°', 'üîã', 'ü™´', 'üîå', 'üì°'
            ],
            saude: [
                'üíâ', 'üíä', 'ü©π', 'ü©∫', 'üî¨', 'üß™', 'üß¨', 'ü©∏', 'üå°Ô∏è', 'ü©ª', 'ü©º', 'ü©ª', 'ü©º', 'ü©π', 'ü©∫', 'üî¨', 'üß™', 'üß¨', 'ü©∏', 'üå°Ô∏è', 'ü©ª', 'ü©º', 'üßë‚Äç‚öïÔ∏è', 'üë©‚Äç‚öïÔ∏è', 'üë®‚Äç‚öïÔ∏è', 'ü§í', 'ü§ï', 'üò∑', 'ü§ß', 'üß†', 'ü´Ä', 'ü´Å', 'ü¶∑', 'ü¶¥', 'üëÄ', 'üëÖ', 'üëÇ', 'üëÉ', 'ü¶∂', 'ü¶µ', 'üí™', 'ü¶æ'
            ],
            esportes: [
                '‚öΩ', 'üèÄ', 'üèà', '‚öæ', 'ü•é', 'üéæ', 'üèê', 'üèâ', 'üèì', 'üè∏', 'üèí', 'üèë', 'üèè', 'ü•ç', 'ü™É', 'ü•Ö', '‚õ≥', 'üéØ', 'ü•å', 'üõ∑', '‚õ∏Ô∏è', 'üéø', 'üèÇ', 'ü™Ç', 'üõπ', 'üõº', 'ü§ø', 'üéΩ', 'üéΩ', 'üèÖ', 'ü•á', 'ü•à', 'ü•â', 'üèÜ', 'üèÜ', 'üéâ', 'üéä', 'üéá', 'üéÜ', 'üéÅ', 'üéÄ', 'üéà', 'üéä'
            ],
            profissoes: [
                'üßë‚Äçüíº', 'üë®‚Äçüíº', 'üë©‚Äçüíº', 'üßë‚Äç‚öñÔ∏è', 'üë®‚Äç‚öñÔ∏è', 'üë©‚Äç‚öñÔ∏è', 'üßë‚Äç‚öïÔ∏è', 'üë®‚Äç‚öïÔ∏è', 'üë©‚Äç‚öïÔ∏è', 'üßë‚Äçüéì', 'üë®‚Äçüéì', 'üë©‚Äçüéì', 'üßë‚Äçüè´', 'üë®‚Äçüè´', 'üë©‚Äçüè´', 'üßë‚Äçüåæ', 'üë®‚Äçüåæ', 'üë©‚Äçüåæ', 'üßë‚Äçüç≥', 'üë®‚Äçüç≥', 'üë©‚Äçüç≥', 'üßë‚Äçüîß', 'üë®‚Äçüîß', 'üë©‚Äçüîß', 'üßë‚Äçüè≠', 'üë®‚Äçüè≠', 'üë©‚Äçüè≠', 'üßë‚Äçüíª', 'üë®‚Äçüíª', 'üë©‚Äçüíª', 'üßë‚Äçüé§', 'üë®‚Äçüé§', 'üë©‚Äçüé§', 'üßë‚Äçüé®', 'üë®‚Äçüé®', 'üë©‚Äçüé®', 'üßë‚ÄçüöÄ', 'üë®‚ÄçüöÄ', 'üë©‚ÄçüöÄ', 'üßë‚Äçüöí', 'üë®‚Äçüöí', 'üë©‚Äçüöí', 'üëÆ', 'üïµÔ∏è', 'üíÇ', 'üë∑', 'üßë‚Äç‚úàÔ∏è', 'üë®‚Äç‚úàÔ∏è', 'üë©‚Äç‚úàÔ∏è'
            ]
        };

        // Mapeia os elementos do DOM isolado
        const usernameInput = shadowRoot.querySelector('#username-input');
        const messageInput = shadowRoot.querySelector('#message-input');
        const sendButton = shadowRoot.querySelector('#send-button');
        const chatMessages = shadowRoot.querySelector('#chat-messages');
        const usersListPanel = shadowRoot.querySelector('#users-list-panel');
        const settingsPanel = shadowRoot.querySelector('#settings-panel');
        const emojiPanel = shadowRoot.querySelector('#emoji-panel');
        const userListElement = shadowRoot.querySelector('#users-list');

        const usernameColorInput = shadowRoot.querySelector('#username-color');
        const textColorInput = shadowRoot.querySelector('#text-color');
        const fontSelect = shadowRoot.querySelector('#font-select');
        const shadowToggleButton = shadowRoot.querySelector('#shadow-toggle-button');
        const backgroundToggleButton = shadowRoot.querySelector('#background-toggle-btn');
        const usersListButton = shadowRoot.querySelector('#users-list-button');
        const settingsButton = shadowRoot.querySelector('.settings-button');
        const emojiButton = shadowRoot.querySelector('#emoji-button');

        // Adiciona event listeners aos bot√µes
        usernameInput.addEventListener('keydown', function(event) {
            if (event.key === 'Enter') {
                const username = this.value.trim();
                if (username) {
                    currentUser = username;
                    this.disabled = true;
                    messageInput.disabled = false;
                    sendButton.disabled = false;
                    messageInput.focus();
                    socket.emit('user connected', { name: currentUser, color: currentUsernameColor, status: 'online' });
                }
            }
        });
        messageInput.addEventListener('keydown', (e) => { if (e.key === 'Enter') { sendMessageOnline(); } });
        sendButton.addEventListener('click', sendMessageOnline);
        usernameColorInput.addEventListener('input', function() { currentUsernameColor = this.value; updateUserNameColor(currentUser, currentUsernameColor); });
        textColorInput.addEventListener('input', function() { currentTextColor = this.value; });
        settingsButton.addEventListener('click', toggleSettingsPanel);
        usersListButton.addEventListener('click', toggleUsersList);
        emojiButton.addEventListener('click', toggleEmojiPanel);
        shadowToggleButton.addEventListener('click', toggleTextShadow);
        backgroundToggleButton.addEventListener('click', toggleBackground);
        fontSelect.addEventListener('change', changeFont);

        shadowRoot.querySelectorAll('.emoji-tabs button').forEach(button => {
            button.addEventListener('click', () => {
                const category = button.getAttribute('onclick').match(/showEmojiCategory\('(.*?)'\)/)[1];
                showEmojiCategory(category);
            });
        });

        // Adapta√ß√£o para os bot√µes de status
        shadowRoot.querySelectorAll('.status-icons button').forEach(button => {
            button.addEventListener('click', () => {
                const status = button.getAttribute('onclick').match(/setStatus\('(.*?)'\)/)[1];
                setStatus(status);
            });
        });

        // Fun√ß√µes do chat (ajustadas para o Shadow DOM)
        function changeFont() {
            // L√≥gica para mudar a fonte (pode ser re-implementada aqui se necess√°rio)
        }
        function addUserToList(username, color, status) {
            const newUser = document.createElement('li');
            newUser.id = `user-${username}`;
            newUser.innerHTML = `<span class="status-indicator ${status}"></span><span class="chat-user-name" style="color:${color}">${username}</span>`;
            userListElement.appendChild(newUser);
        }
        function updateUserNameColor(username, color) {
            const userItem = shadowRoot.querySelector(`#user-${username}`);
            if (userItem) {
                userItem.querySelector('.chat-user-name').style.color = color;
            }
        }
        function setStatus(status) {
            const userItem = shadowRoot.querySelector(`#user-${currentUser}`);
            if (userItem) {
                const indicator = userItem.querySelector('.status-indicator');
                indicator.classList.remove('online', 'busy', 'away');
                indicator.classList.add(status);
            }
        }
        function toggleTextShadow() {
            isTextShadowActive = !isTextShadowActive;
            const chatBox = shadowRoot.querySelector('#chat-messages');
            const button = shadowRoot.querySelector('#shadow-toggle-button');
            if (isTextShadowActive) {
                chatBox.classList.remove('no-shadow');
                button.textContent = 'S';
            } else {
                chatBox.classList.add('no-shadow');
                button.textContent = 'S';
            }
        }
        function toggleSettingsPanel() {
            if (settingsPanel.style.display === 'flex') { settingsPanel.style.display = 'none'; } else { settingsPanel.style.display = 'flex'; usersListPanel.style.display = 'none'; emojiPanel.style.display = 'none'; }
        }
        function toggleBackground() {
            const container = shadowRoot.querySelector('.chat-container');
            isBackgroundActive = !isBackgroundActive;
            if (isBackgroundActive) {
                container.style.backgroundImage = `url('https://i.imgur.com/qkWxt2w.png')`;
                container.classList.add('background-animated');
            } else {
                container.style.backgroundImage = 'none';
                container.style.backgroundColor = '#222';
                container.classList.remove('background-animated');
            }
        }
        function formatText(command) {
            const input = messageInput;
            const start = input.selectionStart;
            const end = input.selectionEnd;
            const selectedText = input.value.substring(start, end);
            if (!selectedText) return;
            let newText = selectedText;
            switch (command) {
                case 'bold': newText = `<b>${selectedText}</b>`; break;
                case 'italic': newText = `<i>${selectedText}</i>`; break;
                case 'underline': newText = `<u>${selectedText}</u>`; break;
                case 'strike': newText = `<s>${selectedText}</s>`; break;
            }
            input.value = input.value.slice(0, start) + newText + input.value.slice(end);
        }
        function insertEmoji(emoji) {
            const input = messageInput;
            const cursorPosition = input.selectionStart;
            const currentValue = input.value;
            input.value = currentValue.slice(0, cursorPosition) + emoji + currentValue.slice(cursorPosition);
            input.focus();
        }
        function toggleEmojiPanel() {
            if (emojiPanel.style.display === 'flex') { emojiPanel.style.display = 'none'; } else { emojiPanel.style.display = 'flex'; usersListPanel.style.display = 'none'; settingsPanel.style.display = 'none'; }
        }
        function toggleUsersList() {
            if (usersListPanel.style.display === 'flex') { usersListPanel.style.display = 'none'; } else { usersListPanel.style.display = 'flex'; settingsPanel.style.display = 'none'; emojiPanel.style.display = 'none'; }
        }
        function renderEmojis(categoryName) {
            const container = shadowRoot.querySelector(`#${categoryName}`);
            if (container.children.length === 0) {
                const emojis = emojiCategories[categoryName];
                let buttonsHtml = '';
                const triplicatedEmojis = emojis.concat(emojis, emojis);
                triplicatedEmojis.forEach(emoji => {
                    buttonsHtml += `<button onclick="insertEmoji('${emoji}')">${emoji}</button>`;
                });
                container.innerHTML = buttonsHtml;
            }
        }
        function showEmojiCategory(category) {
            shadowRoot.querySelectorAll('.emoji-category').forEach(el => el.classList.remove('active'));
            shadowRoot.querySelectorAll('.emoji-tabs button').forEach(el => el.classList.remove('active'));
            shadowRoot.querySelector(`#${category}`).classList.add('active');
            shadowRoot.querySelector(`.emoji-tabs button[onclick*="'${category}'"]`).classList.add('active');
            renderEmojis(category);
        }
        shadowRoot.querySelector('#close-users-btn').addEventListener('click', toggleUsersList);
        shadowRoot.querySelector('#close-settings-btn').addEventListener('click', toggleSettingsPanel);
        shadowRoot.querySelector('#close-emoji-btn').addEventListener('click', toggleEmojiPanel);
    
    
    // Conectando o socket para envio e recebimento de mensagens
    function sendMessageOnline() {
        const message = messageInput.value.trim();
        const username = usernameInput.value.trim();
        const usernameColor = usernameColorInput.value;
        const textColor = textColorInput.value;
        const fontFamily = fontSelect.value;
        const isShadowActive = isTextShadowActive;

        if (message && username) {
            const formattedMessage = {
                username,
                message,
                usernameColor,
                textColor,
                fontFamily,
                isShadowActive
            };
            socket.emit('chat message', formattedMessage);
            messageInput.value = '';
        }
    }

    socket.on('chat message', (msg) => {
        const newMessage = document.createElement('p');
        
        let usernameStyle = `color:${msg.usernameColor};`;
        let messageStyle = `color:${msg.textColor}; font-family: ${msg.fontFamily};`;
        
        if (msg.isShadowActive) {
            usernameStyle += ` text-shadow: 0 0 5px ${msg.usernameColor};`;
            messageStyle += ` text-shadow: 0 0 5px ${msg.textColor};`;
        }

        const usernameSpan = `<b style="${usernameStyle}">${msg.username}:</b>`;
        const messageSpan = `<span style="${messageStyle}">${msg.message}</span>`;
        newMessage.innerHTML = `${usernameSpan} ${messageSpan}`;
        
        chatMessages.appendChild(newMessage);
        chatMessages.scrollTop = chatMessages.scrollHeight;
    });

    socket.on('user list update', (users) => {
        userListElement.innerHTML = '';
        users.forEach(user => {
            const newUser = document.createElement('li');
            newUser.id = `user-${user.name}`;
            newUser.innerHTML = `<span class="status-indicator ${user.status}"></span><span class="chat-user-name" style="color:${user.color}">${user.name}</span>`;
            userListElement.appendChild(newUser);
        });
    });

    showEmojiCategory('smileys');
  })();
</script>
