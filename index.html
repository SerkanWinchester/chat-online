<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Chat Neon V.2.1</title>

<!-- Google Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Roboto&family=Montserrat&family=Open+Sans&family=Lato&family=Oswald&family=Raleway&family=PT+Sans&family=Roboto+Mono&family=Ubuntu&family=Playfair+Display&family=Indie+Flower&family=Pacifico&family=Exo+2&family=Anton&family=Comfortaa&family=Karla&family=Poppins&family=Nunito&family=Fira+Sans&family=Arimo&family=Acme&family=Baloo+2&family=Cairo&family=Dancing+Script&family=Fredoka+One&family=Hind&family=Inconsolata&family=Josefin+Sans&family=Kaushan+Script&family=Lobster&family=Merriweather&family=Oxygen&family=Quicksand&family=Roboto+Slab&family=Shadows+Into+Light&family=Source+Sans+Pro&family=Titillium+Web&family=Varela+Round&family=Work+Sans&family=Zilla+Slab&display=swap" rel="stylesheet">

<style>
:root {
  --neon-blue: #00f0ff;
  --neon-pink: #ff00f0;
  --neon-purple: #a200ff;
}
body, html {
  margin: 0;
  padding: 0;
  height: 100%;
  font-family: 'Roboto', sans-serif;
  background: black;
  overflow: hidden;
}
#loginModal {
  position: fixed;
  top:0; left:0;
  width:100%; height:100%;
  background: rgba(0,0,0,0.85);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 9999;
}
.modal-content {
  background: #111;
  padding: 30px;
  border-radius: 15px;
  text-align: center;
  width: 300px;
  box-shadow: 0 0 20px var(--neon-pink);
  border: 2px solid var(--neon-blue);
  animation: glow 1.5s infinite alternate;
}
@keyframes glow {
  from { box-shadow: 0 0 10px var(--neon-blue); }
  to { box-shadow: 0 0 20px var(--neon-pink); }
}
input, select, button {
  width: 90%;
  margin: 5px 0;
  padding: 10px;
  border-radius: 8px;
  border: none;
  outline: none;
  font-size: 1rem;
}
button {
  cursor: pointer;
  background: linear-gradient(90deg,var(--neon-blue),var(--neon-purple),var(--neon-pink));
  color:white;
  font-weight:bold;
  transition: 0.3s;
}
button:hover {
  transform: scale(1.05);
}
#chatContainer {
  display:none;
  width:100%;
  height:100%;
  position: relative;
  color:white;
}
#friendsList {
  position: absolute;
  left:0; top:0;
  width:200px;
  height:100%;
  background: rgba(10,10,10,0.9);
  overflow-y:auto;
  border-right: 3px solid var(--neon-purple);
  padding:10px;
}
.friend {
  padding:5px;
  margin:5px 0;
  border-radius:5px;
  cursor:pointer;
  border: 1px solid var(--neon-blue);
}
.friend.online { background: rgba(0,255,255,0.1);}
.friend.away { background: rgba(255,255,0,0.1);}
.friend.busy { background: rgba(255,0,0,0.1);}
.friend.blocked { background: rgba(255,0,0,0.3); text-decoration: line-through; }
#mainChat {
  margin-left:210px;
  height:100%;
  display:flex;
  flex-direction:column;
}
#messages {
  flex:1;
  overflow-y:auto;
  padding:10px;
}
#messageInput {
  display:flex;
  align-items:center;
  padding:10px;
  background: rgba(0,0,0,0.8);
}
#messageInput textarea {
  flex:1;
  padding:10px;
  border-radius:10px;
  resize:none;
  font-size:1rem;
  background:black;
  color:white;
}
#messageInput button {
  margin-left:5px;
  padding:10px 20px;
}
.textFormat button {
  margin-right:5px;
}
#backgroundSelect {
  position: absolute;
  right:10px; top:10px;
  z-index: 50;
}
#backgroundSelect button {
  margin: 5px;
}
.neonText {
  animation: neonBlink 1s infinite alternate;
}
@keyframes neonBlink {
  from { text-shadow: 0 0 5px #00f0ff,0 0 10px #00f0ff; }
  to { text-shadow: 0 0 10px #ff00f0,0 0 20px #ff00f0; }
}
.chatPrivate {
  position:absolute;
  right:10px;
  top:10px;
  width:300px;
  height:400px;
  background: rgba(0,0,0,0.9);
  border: 2px solid var(--neon-blue);
  border-radius:10px;
  overflow:hidden;
  display:flex;
  flex-direction:column;
}
.chatPrivateHeader {
  background: rgba(20,20,20,0.95);
  padding:5px;
  font-weight:bold;
  display:flex;
  justify-content: space-between;
}
.chatPrivateMessages {
  flex:1;
  overflow-y:auto;
  padding:5px;
}
.chatPrivateInput {
  display:flex;
  padding:5px;
}
.chatPrivateInput input {
  flex:1;
  padding:5px;
  border-radius:5px;
  border:none;
  outline:none;
}
</style>
</head>
<body>

<!-- Modal Login / Cadastro -->
<div id="loginModal">
  <div class="modal-content">
    <h2>Bem-vindo ao Chat Neon</h2>
    <div id="loginForm">
      <input type="text" id="loginUsername" placeholder="Usuário">
      <input type="password" id="loginPassword" placeholder="Senha">
      <button onclick="loginUser()">Login</button>
      <p>ou <span style="color:cyan; cursor:pointer;" onclick="showRegister()">Cadastrar</span></p>
    </div>
    <div id="registerForm" style="display:none;">
      <input type="text" id="regUsername" placeholder="Usuário">
      <input type="password" id="regPassword" placeholder="Senha">
      <input type="password" id="regConfirm" placeholder="Confirme a senha">
      <button onclick="registerUser()">Cadastrar</button>
      <p>ou <span style="color:cyan; cursor:pointer;" onclick="showLogin()">Login</span></p>
    </div>
  </div>
</div>

<!-- Chat -->
<div id="chatContainer">
  <div id="friendsList">
    <h3>Amigos</h3>
    <div id="friends"></div>
    <button onclick="addFriendPrompt()">Adicionar amigo</button>
    <p>Status:</p>
    <select id="statusSelect" onchange="changeStatus()">
      <option value="online">Online</option>
      <option value="away">Ausente</option>
      <option value="busy">Ocupado</option>
    </select>
  </div>
  <div id="mainChat">
    <div id="messages"></div>
    <div class="textFormat">
      <button onclick="applyFormat('bold')"><b>B</b></button>
      <button onclick="applyFormat('underline')"><u>U</u></button>
      <button onclick="applyFormat('line-through')"><s>S</s></button>
      <button onclick="applyFormat('shadow')">Sombra</button>
      <button onclick="toggleNeon()">Neon</button>
      <select id="fontSelect"></select>
      <button onclick="showEmojiPicker()">😀</button>
    </div>
    <div id="messageInput">
      <textarea id="msgText" rows="2" placeholder="Digite sua mensagem..."></textarea>
      <button onclick="sendMessage()">Enviar</button>
    </div>
  </div>
  <div id="backgroundSelect">
    <button onclick="setBackground('https://xatframe.github.io/xatframes/RobFerrari_Balloons.html')">Balões</button>
    <button onclick="setBackground('https://xatframe.github.io/xatframes/lafleur_sea.html')">Mar</button>
    <button onclick="setBackground('https://xatframe.github.io/xatframes/robferrari_xneon.html')">XNeon</button>
    <button onclick="setBackground('')">Cor sólida/gradiente</button>
  </div>
</div>

<script>
// Usuários e login simples
let users = JSON.parse(localStorage.getItem('users')||'{}');
let currentUser = null;
let blocked = [];

function showRegister() { document.getElementById('loginForm').style.display='none'; document.getElementById('registerForm').style.display='block'; }
function showLogin() { document.getElementById('loginForm').style.display='block'; document.getElementById('registerForm').style.display='none'; }

function registerUser() {
  const u = document.getElementById('regUsername').value;
  const p = document.getElementById('regPassword').value;
  const c = document.getElementById('regConfirm').value;
  if(!u || !p || !c) { alert('Preencha todos os campos'); return; }
  if(p!==c){ alert('Senhas não conferem'); return;}
  if(users[u]) { alert('Usuário já existe'); return;}
  users[u] = {password:p, friends:[], status:'online', prefs:{}, logs:{}, blocked:[]};
  localStorage.setItem('users', JSON.stringify(users));
  alert('Cadastro realizado!');
  showLogin();
}
function loginUser() {
  const u = document.getElementById('loginUsername').value;
  const p = document.getElementById('loginPassword').value;
  if(users[u] && users[u].password===p){
    currentUser = u;
    blocked = users[u].blocked || [];
    document.getElementById('loginModal').style.display='none';
    loadChat();
  } else { alert('Usuário ou senha incorretos'); }
}

// Chat
function loadChat(){
  document.getElementById('friends').innerHTML='';
  users[currentUser].friends.forEach(f=>addFriendUI(f));
  document.getElementById('statusSelect').value=users[currentUser].status;
}

// Amigos
function addFriendPrompt(){
  let f = prompt('Nome do amigo:');
  if(f && !users[currentUser].friends.includes(f)){
    users[currentUser].friends.push(f);
    localStorage.setItem('users',JSON.stringify(users));
    addFriendUI(f);
  }
}
function addFriendUI(f){
  let div = document.createElement('div');
  div.className='friend '+(users[f]?.status||'online');
  if(users[currentUser].blocked.includes(f)) div.classList.add('blocked');
  div.innerText=f;
  div.onclick = ()=>openPrivateChat(f);
  document.getElementById('friends').appendChild(div);
}

// Status
function changeStatus(){
  let s = document.getElementById('statusSelect').value;
  users[currentUser].status = s;
  localStorage.setItem('users',JSON.stringify(users));
  loadChat();
}

// Mensagens
let formats = {bold:false, underline:false, lineThrough:false, shadow:false};
let neonActive = false;
const fonts = ["Roboto","Montserrat","Open Sans","Lato","Oswald","Raleway","PT Sans","Roboto Mono","Ubuntu","Playfair Display","Indie Flower","Pacifico","Exo 2","Anton","Comfortaa","Karla","Poppins","Nunito","Fira Sans","Arimo","Acme","Baloo 2","Cairo","Dancing Script","Fredoka One","Hind","Inconsolata","Josefin Sans","Kaushan Script","Lobster","Merriweather","Oxygen","Quicksand","Roboto Slab","Shadows Into Light","Source Sans Pro","Titillium Web","Varela Round","Work Sans","Zilla Slab"];
let fontSelect = document.getElementById('fontSelect');
fonts.forEach(f=>{
  let opt = document.createElement('option');
  opt.value=f; opt.innerText=f;
  fontSelect.appendChild(opt);
});
function changeFont(){}

// Formatação
function applyFormat(f){ formats[f]=!formats[f]; }
function formatMsg(msg){
  let temp = msg;
  if(formats.bold) temp = '<b>'+temp+'</b>';
  if(formats.underline) temp = '<u>'+temp+'</u>';
  if(formats.lineThrough) temp = '<s>'+temp+'</s>';
  if(formats.shadow) temp = '<span style="text-shadow:2px 2px 5px #0ff">'+temp+'</span>';
  return temp;
}
function toggleNeon(){ neonActive=!neonActive; }

function sendMessage(){
  let msg = document.getElementById('msgText').value;
  if(!msg) return;
  let div = document.createElement('div');
  div.innerHTML = formatMsg(msg);
  if(neonActive) div.classList.add('neonText');
  div.style.fontFamily = fontSelect.value;
  document.getElementById('messages').appendChild(div);
  document.getElementById('msgText').value='';
  document.getElementById('messages').scrollTop = document.getElementById('messages').scrollHeight;

  // Log
  if(!users[currentUser].logs.global) users[currentUser].logs.global=[];
  users[currentUser].logs.global.push({msg, time:Date.now()});
  localStorage.setItem('users',JSON.stringify(users));
}

// Background
function setBackground(url){
  if(url){
    document.body.style.background='url('+url+') no-repeat center center fixed';
    document.body.style.backgroundSize='cover';
  } else {
    let color = prompt('Digite a cor de fundo (hex ou nome) ou gradient:','#000');
    document.body.style.background=color;
  }
}

// Emojis
function showEmojiPicker(){
  let emojis = ["😀","😂","😍","😎","👍","💖","🎉","🔥"];
  let emoji = prompt('Escolha emoji: '+emojis.join(' '));
  if(emoji) document.getElementById('msgText').value += emoji;
}

// Chat privado
function openPrivateChat(friend){
  if(blocked.includes(friend)) { alert('Usuário bloqueado'); return; }
  let existing = document.getElementById('private_'+friend);
  if(existing) return;
  let chatDiv = document.createElement('div');
  chatDiv.className='chatPrivate';
  chatDiv.id='private_'+friend;

  let header = document.createElement('div');
  header.className='chatPrivateHeader';
  header.innerHTML = friend+' <span style="cursor:pointer;" onclick="closePrivate(\''+friend+'\')">X</span>';
  chatDiv.appendChild(header);

  let msgsDiv = document.createElement('div');
  msgsDiv.className='chatPrivateMessages';
  chatDiv.appendChild(msgsDiv);

  let inputDiv = document.createElement('div');
  inputDiv.className='chatPrivateInput';
  let input = document.createElement('input');
  input.placeholder='Mensagem...';
  inputDiv.appendChild(input);
  let sendBtn = document.createElement('button');
  sendBtn.innerText='Enviar';
  sendBtn.onclick = ()=>{
    let text = input.value;
    if(!text) return;
    let msg = document.createElement('div');
    msg.innerText = text;
    msgsDiv.appendChild(msg);
    input.value='';

    // Log privado
    if(!users[currentUser].logs[friend]) users[currentUser].logs[friend]=[];
    users[currentUser].logs[friend].push({msg:text, time:Date.now()});
    localStorage.setItem('users',JSON.stringify(users));
  };
  inputDiv.appendChild(sendBtn);
  chatDiv.appendChild(inputDiv);

  document.body.appendChild(chatDiv);
}

function closePrivate(friend){
  let d = document.getElementById('private_'+friend);
  if(d) d.remove();
}

// Bloquear
function blockFriend(friend){
  if(!users[currentUser].blocked.includes(friend)){
    users[currentUser].blocked.push(friend);
    localStorage.setItem('users',JSON.stringify(users));
    blocked.push(friend);
    loadChat();
  }
}
</script>
</body>
</html>
